<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EasyClinic ‚Äî In√≠cio</title>

  <!-- SCRIPT DE VALIDA√á√ÉO DE LOGIN -->
  <script>
    const logado = localStorage.getItem('usuario_logado');
    if(!logado){
      window.location.href = "login.html";
    }
  </script>

  <style>
    :root{
      --bg:#f6f8fb;
      --card:#ffffff;
      --muted:#69707a;
      --accent:#4f46e5;
      --accent-2:#06b6d4;
      --success:#16a34a;
      --shadow: 0 6px 18px rgba(16,24,40,0.08);
      --radius:12px;
      --glass: rgba(255,255,255,0.6);
      --max-width:1200px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:#0f172a}
    .app{display:flex;min-height:100vh;}

    /* FIX ‚Äî igual ao comportamento da p√°gina Consultas */
  .main, .content {
    transform: none !important;
    zoom: 1 !important;
  }

  .sidebar {
    flex-shrink: 0 !important;
  }

/* SIDEBAR */
.sidebar{
  width:260px;
  background:white;
  border-right:1px solid #e6eef6;
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:14px;
  transition:.25s ease;
}
.sidebar.collapsed{
  width:72px;
  padding-left:10px;
  padding-right:10px;
}

.logo{
  width:44px;height:44px;border-radius:10px;
  background:linear-gradient(135deg,var(--accent),var(--accent-2));
  color:white;font-weight:700;display:flex;align-items:center;justify-content:center;
}

.brand{display:flex;gap:12px;align-items:center;font-weight:700}
.titles{display:flex;flex-direction:column}
.small{font-size:12px;color:var(--muted)}

.nav{
  display:flex;
  flex-direction:column;
  gap:6px;
  margin-top:10px;
}
.nav a{
  display:flex;
  align-items:center;
  gap:12px;
  padding:10px;
  border-radius:10px;
  font-weight:600;
  text-decoration:none;
  color:#0f172a;
}
.nav a:hover{background:#f1f5f9}
.nav .active{
  background:linear-gradient(90deg,rgba(79,70,229,0.12),rgba(6,182,212,0.06));
  box-shadow:var(--shadow);
}

.sidebar.collapsed .titles,
.sidebar.collapsed .text,
.sidebar.collapsed .sidebar-footer{
  display:none;
}
.sidebar.collapsed .logo{margin:auto}

.sidebar-footer{
  margin-top:auto;
  font-size:12px;
  color:var(--muted);
  text-align:center;
}


/* MAIN */
    .main{flex:1;display:flex;flex-direction:column}
    header{height:72px;background:transparent;display:flex;align-items:center;justify-content:space-between;padding:16px 28px;border-bottom:1px solid rgba(15,23,42,0.04);position:relative}
    .search{display:flex;align-items:center;gap:12px}
    .search input{padding:10px 12px;border-radius:10px;border:1px solid #e6eef6;background:#fff;min-width:260px}
    .controls{display:flex;align-items:center;gap:12px}
    .icon-btn{width:40px;height:40px;border-radius:10px;background:#fff;border:1px solid #e6eef6;display:flex;align-items:center;justify-content:center;cursor:pointer}
    .icon-btn:hover{background:#f1f5f9}
    .avatar{width:40px;height:40px;border-radius:999px;background:#c7d2fe;display:flex;align-items:center;justify-content:center;font-weight:700;color:#1e293b;cursor:pointer}

    /* Notif popup */
    .notif-popup{
      position:absolute;top:74px;right:28px;width:300px;background:var(--card);border-radius:12px;box-shadow:var(--shadow);padding:12px;display:none;z-index:50;
    }
    .notif-popup h4{margin:0 0 8px 0}
    .notif-item{padding:8px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfdff);margin-bottom:8px;border:1px solid #eef3fb;display:flex;justify-content:space-between;align-items:center}
    .notif-item .meta{font-size:12px;color:var(--muted)}

    .content{padding:28px;max-width:var(--max-width);margin:0 auto;width:100%}
    .row{display:flex;gap:18px}

    .cards{display:grid;grid-template-columns:repeat(4,1fr);gap:18px;margin-bottom:18px}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:var(--shadow);min-height:88px}
    .card .label{font-size:13px;color:var(--muted);margin-bottom:8px}
    .card .value{font-size:20px;font-weight:700}

    .panel{display:flex;gap:18px}
    .panel-left{flex:2;background:transparent}
    .panel-right{flex:1}

    .box{background:var(--card);padding:18px;border-radius:12px;box-shadow:var(--shadow)}
    .box h3{margin:0 0 12px 0;font-size:16px}

    .activities{display:flex;flex-direction:column;gap:10px}
    .act{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg, #fff,#fbfdff);border:1px solid #eef3fb}
    .act-left{display:flex;flex-direction:column}
    .act-time{font-size:12px;color:var(--muted)}

    table{Width:100%;border-collapse:collapse;font-size:14px}
    th,td{padding:10px;text-align:left;border-bottom:1px solid #f3f6fb}

    .btn{padding:8px 12px;border-radius:10px;border:0;background:var(--accent);color:white;font-weight:700;cursor:pointer}
    .btn-ghost{padding:8px 12px;border-radius:10px;border:1px solid #e6eef6;background:transparent;color:#0f172a;cursor:pointer}

/* collapsed sidebar styles */
    .sidebar.collapsed .brand .titles,
    .sidebar.collapsed .nav a .text,
    .sidebar.collapsed .sidebar-footer{
      display:none;
    }
    .sidebar.collapsed .logo{margin:auto}
    @media (max-width:900px){
      .cards{grid-template-columns:repeat(2,1fr)}
      .panel{flex-direction:column}
    }
  </style>
</head>
<body>
  <div class="app">
    <aside id="sidebar" class="sidebar">
      <div class="brand">
        <div class="logo">EC</div>
        <div class="titles">
          <div>EasyClinic</div>
          <div class="small">Painel Administrativo</div>
        </div>
      </div>
    
      <nav class="nav">
        <a href="index.html" class="active"><span class="icon">üè†</span><span class="text">In√≠cio</span></a>
        <a href="pacientes.html"><span class="icon">üò∑</span><span class="text">Pacientes</span></a>
        <a href="consultas.html"><span class="icon">üìã</span><span class="text">Consultas</span></a>
        <a href="agenda-medica.html"><span class="icon">üìÖ</span><span class="text">Agenda M√©dica</span></a>
        <a href="gerenciar-usuarios.html"><span class="icon">üë§</span><span class="text">Usu√°rios</span></a>
        <a href="relatorios.html"><span class="icon">üìä</span><span class="text">Relat√≥rios</span></a>
        <a href="configuracoes.html"><span class="icon">‚öôÔ∏è</span><span class="text">Configura√ß√µes</span></a>
      </nav>
    
      <div class="sidebar-footer">Vers√£o 1.0</div>
    </aside>
    
    <div class="main">
      <header>
        <div style="display:flex;align-items:center;gap:12px">
          <div id="btnToggle" class="icon-btn" title="Abrir/Fechar menu">‚ò∞</div>
          <div class="search"><input id="searchInput" placeholder="Buscar pacientes ou consultas..." /></div>
        </div>

        <div style="display:flex;align-items:center;gap:16px;position:relative;">
          <div id="btnNotif" class="icon-btn">üîî</div>
          <div id="notifPopup" class="notif-popup">
            <h4>Notifica√ß√µes</h4>
            <div class="notif-item"><div><strong>Consulta marcada</strong><div class="meta">14:00h</div></div><div class="meta">Recep√ß√£o</div></div>
            <div class="notif-item"><div><strong>Novo paciente</strong><div class="meta">10 min atr√°s</div></div><div class="meta">Recep√ß√£o</div></div>
            <div style="text-align:center;margin-top:8px"><button id="btnClearNotif" class="btn-ghost">Marcar todas como lidas</button></div>
          </div>

          <div style="text-align:right">
            <div style="font-size:13px;color:var(--muted)">Ol√°,</div>
            <div style="font-weight:700">Maria Silva</div>
          </div>
    
          <div id="avatar" class="avatar">MS</div>
        </div>
      </header>

      <main class="content">
        <div class="cards">
          <div class="card"><div class="label">Consultas do Dia</div><div class="value" id="cardConsultas">32</div></div>
          <div class="card"><div class="label">Pacientes Cadastrados</div><div class="value" id="cardPacientes">680</div></div>
          <div class="card"><div class="label">M√©dicos Ativos</div><div class="value" id="cardMedicos">12</div></div>
          <div class="card"><div class="label">Cancelamentos</div><div class="value" id="cardCancelamentos">3</div></div>
        </div>

        <div class="panel">
          <section class="panel-left">
            <div class="box">
              <h3>Consultas por Semana</h3>
              <canvas id="chart" style="width:100%;height:200px"></canvas>
            </div>

            <div class="box" style="margin-top:18px">
              <h3>Pr√≥ximas Consultas</h3>
              <table>
                <thead>
                  <tr><th>Hor√°rio</th><th>Paciente</th><th>M√©dico</th><th>Status</th></tr>
                </thead>
                <tbody id="proxConsultas">
                  <tr><td>09:00</td><td>Jo√£o Pereira</td><td>Dr. Paula</td><td>Confirmada</td></tr>
                  <tr><td>09:30</td><td>Maria Souza</td><td>Dr. Paulo</td><td>Confirmada</td></tr>
                  <tr><td>10:00</td><td>Carlos Lima</td><td>Dr. Ana</td><td>Check-in</td></tr>
                </tbody>
              </table>
            </div>
          </section>

          <aside class="panel-right">
            <div class="box">
              <h3>Atividades Recentes</h3>
              <div class="activities" id="activities">
                <div class="act"><div class="act-left"><strong>Consulta marcada</strong><div class="act-time">Jo√£o - 14:00</div></div><div class="small muted">Recep√ß√£o</div></div>
                <div class="act"><div class="act-left"><strong>Novo paciente</strong><div class="act-time">Maria Souza</div></div><div class="small muted">Recep√ß√£o</div></div>
              </div>
            </div>
          </aside>
        </div>
      </main>
    </div>
  </div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Carrega nome do usu√°rio (sem alterar HTML estruturalmente)
  (function fillUserInfo(){
    try{
      const user = JSON.parse(localStorage.getItem('usuario_logado'));
      if(!user) return;

      // 1) Substitui "Maria Silva" pelo nome do usu√°rio sem precisar de ID.
      //    Localiza o container "text-align:right" dentro do header e pega o 2¬∫ filho (o nome).
      const nameContainer = document.querySelector('header div[style*="text-align:right"] > div:nth-child(2)');
      if(nameContainer && user.nome){
        nameContainer.textContent = user.nome;
      }

      // 2) Atualiza iniciais do avatar (elemento j√° tem id="avatar" no HTML original)
      if(user.nome){
        const iniciais = user.nome
          .split(' ')
          .map(n => n.trim()[0] || '')
          .join('')
          .substring(0,2)
          .toUpperCase();
        const avatarEl = document.getElementById('avatar');
        if(avatarEl) avatarEl.textContent = iniciais || '??';
      }
    }catch(err){
      console.warn('Erro ao preencher info do usu√°rio:', err);
    }
  })();

  // Sidebar toggle
  const sidebar = document.getElementById('sidebar');
  const btnToggle = document.getElementById('btnToggle');
  btnToggle.addEventListener('click', ()=> {
    sidebar.classList.toggle('collapsed');
  });

  // Notifications popup
  const btnNotif = document.getElementById('btnNotif');
  const notifPopup = document.getElementById('notifPopup');
  const btnClearNotif = document.getElementById('btnClearNotif');

  function closeNotif() {
    notifPopup.style.display = 'none';
    notifPopup.setAttribute('aria-hidden','true');
  }
  function openNotif() {
    notifPopup.style.display = 'block';
    notifPopup.setAttribute('aria-hidden','false');
  }

  btnNotif.addEventListener('click', (e)=>{
    e.stopPropagation();
    if(notifPopup.style.display === 'block'){
      closeNotif();
    } else {
      openNotif();
    }
  });

  // Close notif when clicking outside
  document.addEventListener('click', (e)=>{
    if(!notifPopup.contains(e.target) && e.target !== btnNotif){
      closeNotif();
    }
  });

  btnClearNotif.addEventListener('click', ()=>{
  // remove todos os itens existentes
  document.querySelectorAll('.notif-item').forEach(n => n.remove());

  // verifica se j√° existe a mensagem "Nenhuma notifica√ß√£o"
  const existe = notifPopup.querySelector('.empty-notif');
  if(!existe){
    const empty = document.createElement('div');
    empty.classList.add('empty-notif'); // adiciona classe para controle
    empty.style.textAlign = 'center';
    empty.style.color = 'var(--muted)';
    empty.style.padding = '8px';
    empty.textContent = 'Nenhuma notifica√ß√£o.';
    notifPopup.insertBefore(empty, btnClearNotif.parentElement);
  }
});

  // Avatar click -> configura√ß√µes (direcionamento, sem logout)
  document.getElementById('avatar').addEventListener('click', ()=> {
    window.location.href = 'configuracoes.html';
  });

  // Small search interaction (optional - just filters next consultations)
  document.getElementById('searchInput').addEventListener('input', (e)=>{
    const v = e.target.value.toLowerCase();
    document.querySelectorAll('#proxConsultas tbody, #proxConsultas tr');
    const rows = document.querySelectorAll('#proxConsultas tr');
    rows.forEach(r=>{
      r.style.display = r.textContent.toLowerCase().includes(v) ? '' : 'none';
    });
  });
</script>
</body>
</html>
